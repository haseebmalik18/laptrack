{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/haseebulhaqmalik/Desktop/lap-lens/web/app/components/TrackMapWithBoundaries.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\n\ninterface BoundaryPoint {\n  distance: number;\n  x: number;\n  z: number;\n}\n\ninterface TrackBoundaries {\n  track: {\n    id: number;\n    name: string;\n  };\n  left: BoundaryPoint[];\n  right: BoundaryPoint[];\n  originalPointCount: {\n    left: number;\n    right: number;\n  };\n  processedPointCount: {\n    left: number;\n    right: number;\n  };\n}\n\ninterface TrackMapWithBoundariesProps {\n  lapData: any;\n  corners?: any[];\n  currentIndex?: number;\n  trackName?: string;\n}\n\nexport function TrackMapWithBoundaries({\n  lapData,\n  corners = [],\n  currentIndex = 0,\n  trackName = \"sakhir-(bahrain)\",\n}: TrackMapWithBoundariesProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [boundaries, setBoundaries] = useState<TrackBoundaries | null>(null);\n  const [showBoundaries, setShowBoundaries] = useState(true);\n  const [showRacingLine, setShowRacingLine] = useState(true);\n  const [showBrakingZones, setShowBrakingZones] = useState(true);\n  const [showCornerMarkers, setShowCornerMarkers] = useState(true);\n  const [tooltip, setTooltip] = useState<{ x: number; y: number; text: string } | null>(null);\n\n  // Load boundaries\n  useEffect(() => {\n    fetch(`/api/boundaries/${trackName}`)\n      .then(res => res.json())\n      .then(data => {\n        console.log('Loaded boundaries:', data);\n        setBoundaries(data);\n      })\n      .catch(err => console.error('Failed to load boundaries:', err));\n  }, [trackName]);\n\n  useEffect(() => {\n    if (!canvasRef.current || !lapData?.telemetry) {\n      return;\n    }\n\n    const telemetry = lapData.telemetry;\n    if (telemetry.length === 0) return;\n\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    const dpr = window.devicePixelRatio || 1;\n    const rect = canvas.getBoundingClientRect();\n    canvas.width = rect.width * dpr;\n    canvas.height = rect.height * dpr;\n    ctx.scale(dpr, dpr);\n\n    const width = rect.width;\n    const height = rect.height;\n    const padding = 60;\n\n    // Collect all coordinates for bounds (including boundaries)\n    let allX = telemetry.map((p: any) => p.y);\n    let allY = telemetry.map((p: any) => -p.x);\n\n    if (boundaries && showBoundaries) {\n      boundaries.left.forEach(p => {\n        allX.push(p.z);\n        allY.push(-p.x);\n      });\n      boundaries.right.forEach(p => {\n        allX.push(p.z);\n        allY.push(-p.x);\n      });\n    }\n\n    const minX = Math.min(...allX);\n    const maxX = Math.max(...allX);\n    const minY = Math.min(...allY);\n    const maxY = Math.max(...allY);\n\n    const rangeX = maxX - minX;\n    const rangeY = maxY - minY;\n    const scale = Math.min((width - padding * 2) / rangeX, (height - padding * 2) / rangeY);\n\n    const toScreenX = (x: number, y: number) => {\n      const rx = y;\n      return padding + (rx - minX) * scale;\n    };\n    const toScreenY = (x: number, y: number) => {\n      const ry = -x;\n      return padding + (ry - minY) * scale;\n    };\n\n    // Clear background\n    ctx.fillStyle = \"#0a0a0a\";\n    ctx.fillRect(0, 0, width, height);\n\n    // Draw track boundaries\n    if (boundaries && showBoundaries) {\n      // Draw track surface (filled area between boundaries)\n      ctx.fillStyle = \"#1a1a1a\";\n      ctx.beginPath();\n\n      // Left boundary\n      boundaries.left.forEach((p, i) => {\n        const x = toScreenX(p.x, p.z);\n        const y = toScreenY(p.x, p.z);\n        if (i === 0) ctx.moveTo(x, y);\n        else ctx.lineTo(x, y);\n      });\n\n      // Right boundary (reverse to close polygon)\n      for (let i = boundaries.right.length - 1; i >= 0; i--) {\n        const p = boundaries.right[i];\n        const x = toScreenX(p.x, p.z);\n        const y = toScreenY(p.x, p.z);\n        ctx.lineTo(x, y);\n      }\n\n      ctx.closePath();\n      ctx.fill();\n\n      // Draw boundary lines\n      // Left boundary\n      ctx.strokeStyle = \"rgba(255, 68, 68, 0.6)\";\n      ctx.lineWidth = 2;\n      ctx.beginPath();\n      boundaries.left.forEach((p, i) => {\n        const x = toScreenX(p.x, p.z);\n        const y = toScreenY(p.x, p.z);\n        if (i === 0) ctx.moveTo(x, y);\n        else ctx.lineTo(x, y);\n      });\n      ctx.stroke();\n\n      // Right boundary\n      ctx.strokeStyle = \"rgba(68, 136, 255, 0.6)\";\n      ctx.lineWidth = 2;\n      ctx.beginPath();\n      boundaries.right.forEach((p, i) => {\n        const x = toScreenX(p.x, p.z);\n        const y = toScreenY(p.x, p.z);\n        if (i === 0) ctx.moveTo(x, y);\n        else ctx.lineTo(x, y);\n      });\n      ctx.stroke();\n\n      // Draw start/finish line\n      if (boundaries.left.length > 0 && boundaries.right.length > 0) {\n        const leftStart = boundaries.left[0];\n        const rightStart = boundaries.right[0];\n        ctx.strokeStyle = \"rgba(0, 255, 136, 0.8)\";\n        ctx.lineWidth = 3;\n        ctx.setLineDash([5, 5]);\n        ctx.beginPath();\n        ctx.moveTo(toScreenX(leftStart.x, leftStart.z), toScreenY(leftStart.x, leftStart.z));\n        ctx.lineTo(toScreenX(rightStart.x, rightStart.z), toScreenY(rightStart.x, rightStart.z));\n        ctx.stroke();\n        ctx.setLineDash([]);\n      }\n    }\n\n    // Draw braking zones\n    if (showBrakingZones) {\n      corners.forEach((corner: any) => {\n        if (corner.brakingZone) {\n          const bz = corner.brakingZone;\n          const startIdx = telemetry.findIndex((p: any) => p.distance >= bz.entryDistance);\n          const endIdx = telemetry.findIndex((p: any) => p.distance >= bz.exitDistance);\n\n          if (startIdx >= 0 && endIdx >= 0) {\n            ctx.strokeStyle = \"rgba(255, 60, 60, 0.7)\";\n            ctx.lineWidth = 8;\n            ctx.lineCap = \"round\";\n            ctx.lineJoin = \"round\";\n\n            ctx.beginPath();\n            for (let i = startIdx; i <= endIdx; i++) {\n              const p = telemetry[i];\n              const x = toScreenX(p.x, p.y);\n              const y = toScreenY(p.x, p.y);\n              if (i === startIdx) ctx.moveTo(x, y);\n              else ctx.lineTo(x, y);\n            }\n            ctx.stroke();\n          }\n        }\n      });\n    }\n\n    // Draw racing line\n    if (showRacingLine) {\n      ctx.lineWidth = 3;\n      ctx.strokeStyle = \"#ffff00\";\n      ctx.lineCap = \"round\";\n      ctx.lineJoin = \"round\";\n\n      ctx.beginPath();\n      telemetry.forEach((p: any, i: number) => {\n        const x = toScreenX(p.x, p.y);\n        const y = toScreenY(p.x, p.y);\n        if (i === 0) ctx.moveTo(x, y);\n        else ctx.lineTo(x, y);\n      });\n      ctx.stroke();\n    }\n\n    // Draw corner markers\n    if (showCornerMarkers) {\n      corners.forEach((corner: any, idx: number) => {\n        const apexPoint = telemetry.find(\n          (p: any) => Math.abs(p.distance - corner.apexDistance) < 5\n        );\n\n        if (apexPoint) {\n          const x = toScreenX(apexPoint.x, apexPoint.y);\n          const y = toScreenY(apexPoint.x, apexPoint.y);\n\n          ctx.fillStyle = \"#000\";\n          ctx.beginPath();\n          ctx.arc(x, y, 16, 0, Math.PI * 2);\n          ctx.fill();\n\n          ctx.fillStyle = \"#fff\";\n          ctx.beginPath();\n          ctx.arc(x, y, 14, 0, Math.PI * 2);\n          ctx.fill();\n\n          ctx.fillStyle = \"#000\";\n          ctx.font = \"bold 11px sans-serif\";\n          ctx.textAlign = \"center\";\n          ctx.textBaseline = \"middle\";\n          ctx.fillText(`${idx + 1}`, x, y);\n        }\n      });\n    }\n\n    // Draw current position\n    const currentPoint = telemetry[Math.floor(currentIndex)];\n    const nextPoint = telemetry[Math.floor(currentIndex) + 1];\n\n    if (currentPoint && nextPoint) {\n      const cx = toScreenX(currentPoint.x, currentPoint.y);\n      const cy = toScreenY(currentPoint.x, currentPoint.y);\n      const nx = toScreenX(nextPoint.x, nextPoint.y);\n      const ny = toScreenY(nextPoint.x, nextPoint.y);\n\n      const angle = Math.atan2(ny - cy, nx - cx);\n\n      ctx.save();\n      ctx.translate(cx, cy);\n      ctx.rotate(angle);\n\n      ctx.shadowColor = \"rgba(0, 255, 255, 0.6)\";\n      ctx.shadowBlur = 10;\n\n      ctx.fillStyle = \"#00ffff\";\n      ctx.beginPath();\n      ctx.moveTo(8, 0);\n      ctx.lineTo(-6, -5);\n      ctx.lineTo(-4, 0);\n      ctx.lineTo(-6, 5);\n      ctx.closePath();\n      ctx.fill();\n\n      ctx.shadowBlur = 0;\n      ctx.strokeStyle = \"#000\";\n      ctx.lineWidth = 1.5;\n      ctx.stroke();\n\n      ctx.restore();\n    }\n  }, [lapData, corners, currentIndex, boundaries, showBoundaries, showRacingLine, showBrakingZones, showCornerMarkers]);\n\n  return (\n    <div className=\"relative rounded-xl border border-zinc-800 bg-zinc-900/50 p-6\">\n      <div className=\"mb-4 flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-xl font-semibold text-white\">Track Map</h2>\n          {boundaries && (\n            <p className=\"text-sm text-zinc-500 mt-1\">\n              {boundaries.track.name} | Boundaries: {boundaries.processedPointCount.left + boundaries.processedPointCount.right} points\n            </p>\n          )}\n        </div>\n\n        {/* Toggle controls */}\n        <div className=\"flex items-center gap-3\">\n          <button\n            onClick={() => setShowBoundaries(!showBoundaries)}\n            className={`px-3 py-1.5 text-sm rounded-md transition-colors ${\n              showBoundaries\n                ? 'bg-zinc-700 text-white'\n                : 'bg-zinc-800/50 text-zinc-500 hover:bg-zinc-800'\n            }`}\n          >\n            Boundaries\n          </button>\n          <button\n            onClick={() => setShowRacingLine(!showRacingLine)}\n            className={`px-3 py-1.5 text-sm rounded-md transition-colors ${\n              showRacingLine\n                ? 'bg-zinc-700 text-white'\n                : 'bg-zinc-800/50 text-zinc-500 hover:bg-zinc-800'\n            }`}\n          >\n            Racing Line\n          </button>\n          <button\n            onClick={() => setShowBrakingZones(!showBrakingZones)}\n            className={`px-3 py-1.5 text-sm rounded-md transition-colors ${\n              showBrakingZones\n                ? 'bg-zinc-700 text-white'\n                : 'bg-zinc-800/50 text-zinc-500 hover:bg-zinc-800'\n            }`}\n          >\n            Braking\n          </button>\n          <button\n            onClick={() => setShowCornerMarkers(!showCornerMarkers)}\n            className={`px-3 py-1.5 text-sm rounded-md transition-colors ${\n              showCornerMarkers\n                ? 'bg-zinc-700 text-white'\n                : 'bg-zinc-800/50 text-zinc-500 hover:bg-zinc-800'\n            }`}\n          >\n            Corners\n          </button>\n        </div>\n      </div>\n\n      <canvas\n        ref={canvasRef}\n        className=\"w-full rounded-lg cursor-crosshair bg-black\"\n        style={{ height: \"800px\" }}\n      />\n\n      {tooltip && (\n        <div\n          className=\"pointer-events-none fixed z-50 rounded bg-black px-3 py-2 text-sm text-white shadow-lg border border-zinc-700\"\n          style={{\n            left: tooltip.x + 10,\n            top: tooltip.y + 10,\n          }}\n        >\n          {tooltip.text}\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 366, "column": 0}, "map": {"version":3,"sources":["file:///Users/haseebulhaqmalik/Desktop/lap-lens/web/app/track-viewer/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { TrackMapWithBoundaries } from \"../components/TrackMapWithBoundaries\";\n\nexport default function TrackViewerPage() {\n  const [lapData, setLapData] = useState<any>(null);\n  const [corners, setCorners] = useState<any[]>([]);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    // Load lap 1 data\n    Promise.all([\n      fetch('/api/laps/1').then(res => res.json()),\n      fetch('/api/corners/bahrain').then(res => res.json()).catch(() => [])\n    ])\n      .then(([lapDataRes, cornersRes]) => {\n        setLapData(lapDataRes);\n        setCorners(Array.isArray(cornersRes) ? cornersRes : []);\n        setLoading(false);\n      })\n      .catch(err => {\n        console.error('Failed to load data:', err);\n        setLoading(false);\n      });\n  }, []);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-zinc-950 flex items-center justify-center\">\n        <div className=\"text-zinc-400\">Loading track data...</div>\n      </div>\n    );\n  }\n\n  if (!lapData) {\n    return (\n      <div className=\"min-h-screen bg-zinc-950 flex items-center justify-center\">\n        <div className=\"text-zinc-400\">No lap data found. Record a lap first!</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-zinc-950 p-8\">\n      <div className=\"max-w-[1600px] mx-auto space-y-6\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-4xl font-bold text-white mb-2\">\n            Track Viewer\n          </h1>\n          <p className=\"text-zinc-400\">\n            2D track map with boundaries, racing line, and telemetry data\n          </p>\n        </div>\n\n        {/* Track Map */}\n        <TrackMapWithBoundaries\n          lapData={lapData}\n          corners={corners}\n          currentIndex={currentIndex}\n          trackName=\"sakhir-(bahrain)\"\n        />\n\n        {/* Lap Info */}\n        {lapData.metadata && (\n          <div className=\"grid grid-cols-4 gap-4\">\n            <div className=\"bg-zinc-900/50 border border-zinc-800 rounded-lg p-4\">\n              <div className=\"text-zinc-500 text-sm mb-1\">Track</div>\n              <div className=\"text-white text-lg font-semibold\">\n                {lapData.metadata.trackName}\n              </div>\n            </div>\n            <div className=\"bg-zinc-900/50 border border-zinc-800 rounded-lg p-4\">\n              <div className=\"text-zinc-500 text-sm mb-1\">Car</div>\n              <div className=\"text-white text-lg font-semibold\">\n                {lapData.metadata.carName}\n              </div>\n            </div>\n            <div className=\"bg-zinc-900/50 border border-zinc-800 rounded-lg p-4\">\n              <div className=\"text-zinc-500 text-sm mb-1\">Lap Time</div>\n              <div className=\"text-white text-lg font-semibold\">\n                {(lapData.metadata.lapTimeMs / 1000).toFixed(3)}s\n              </div>\n            </div>\n            <div className=\"bg-zinc-900/50 border border-zinc-800 rounded-lg p-4\">\n              <div className=\"text-zinc-500 text-sm mb-1\">Data Points</div>\n              <div className=\"text-white text-lg font-semibold\">\n                {lapData.metadata.pointCount.toLocaleString()}\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKe,SAAS;IACtB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kPAAQ,EAAM;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kPAAQ,EAAQ,EAAE;IAChD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,kPAAQ,EAAC;IACjD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kPAAQ,EAAC;IAEvC,IAAA,mPAAS,EAAC;QACR,kBAAkB;QAClB,QAAQ,GAAG,CAAC;YACV,MAAM,eAAe,IAAI,CAAC,CAAA,MAAO,IAAI,IAAI;YACzC,MAAM,wBAAwB,IAAI,CAAC,CAAA,MAAO,IAAI,IAAI,IAAI,KAAK,CAAC,IAAM,EAAE;SACrE,EACE,IAAI,CAAC,CAAC,CAAC,YAAY,WAAW;YAC7B,WAAW;YACX,WAAW,MAAM,OAAO,CAAC,cAAc,aAAa,EAAE;YACtD,WAAW;QACb,GACC,KAAK,CAAC,CAAA;YACL,QAAQ,KAAK,CAAC,wBAAwB;YACtC,WAAW;QACb;IACJ,GAAG,EAAE;IAEL,IAAI,SAAS;QACX,qBACE,+QAAC;YAAI,WAAU;sBACb,cAAA,+QAAC;gBAAI,WAAU;0BAAgB;;;;;;;;;;;IAGrC;IAEA,IAAI,CAAC,SAAS;QACZ,qBACE,+QAAC;YAAI,WAAU;sBACb,cAAA,+QAAC;gBAAI,WAAU;0BAAgB;;;;;;;;;;;IAGrC;IAEA,qBACE,+QAAC;QAAI,WAAU;kBACb,cAAA,+QAAC;YAAI,WAAU;;8BAEb,+QAAC;oBAAI,WAAU;;sCACb,+QAAC;4BAAG,WAAU;sCAAqC;;;;;;sCAGnD,+QAAC;4BAAE,WAAU;sCAAgB;;;;;;;;;;;;8BAM/B,+QAAC,uMAAsB;oBACrB,SAAS;oBACT,SAAS;oBACT,cAAc;oBACd,WAAU;;;;;;gBAIX,QAAQ,QAAQ,kBACf,+QAAC;oBAAI,WAAU;;sCACb,+QAAC;4BAAI,WAAU;;8CACb,+QAAC;oCAAI,WAAU;8CAA6B;;;;;;8CAC5C,+QAAC;oCAAI,WAAU;8CACZ,QAAQ,QAAQ,CAAC,SAAS;;;;;;;;;;;;sCAG/B,+QAAC;4BAAI,WAAU;;8CACb,+QAAC;oCAAI,WAAU;8CAA6B;;;;;;8CAC5C,+QAAC;oCAAI,WAAU;8CACZ,QAAQ,QAAQ,CAAC,OAAO;;;;;;;;;;;;sCAG7B,+QAAC;4BAAI,WAAU;;8CACb,+QAAC;oCAAI,WAAU;8CAA6B;;;;;;8CAC5C,+QAAC;oCAAI,WAAU;;wCACZ,CAAC,QAAQ,QAAQ,CAAC,SAAS,GAAG,IAAI,EAAE,OAAO,CAAC;wCAAG;;;;;;;;;;;;;sCAGpD,+QAAC;4BAAI,WAAU;;8CACb,+QAAC;oCAAI,WAAU;8CAA6B;;;;;;8CAC5C,+QAAC;oCAAI,WAAU;8CACZ,QAAQ,QAAQ,CAAC,UAAU,CAAC,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQ3D"}},
    {"offset": {"line": 598, "column": 0}, "map": {"version":3,"sources":["file:///Users/haseebulhaqmalik/Desktop/lap-lens/web/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0]}},
    {"offset": {"line": 617, "column": 0}, "map": {"version":3,"sources":["file:///Users/haseebulhaqmalik/Desktop/lap-lens/web/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,iJACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}},
    {"offset": {"line": 622, "column": 0}, "map": {"version":3,"sources":["file:///Users/haseebulhaqmalik/Desktop/lap-lens/web/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n"],"names":["module","exports","require","vendored","React"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,iJACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK","ignoreList":[0]}}]
}